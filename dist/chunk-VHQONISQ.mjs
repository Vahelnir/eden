import{a as L,b as x}from"./chunk-YUVTMDMN.mjs";var W=(n,e,t)=>{if(n.endsWith("/")||(n+="/"),e==="index"&&(e=""),!t||!Object.keys(t).length)return`${n}${e}`;let s="";for(let[c,r]of Object.entries(t))s+=`${c}=${r}&`;return`${n}${e}?${s.slice(0,-1)}`};var F=typeof FileList>"u",K=n=>F?n instanceof Blob:n instanceof FileList||n instanceof File,J=n=>{if(!n)return!1;for(let e in n){if(K(n[e]))return!0;if(Array.isArray(n[e])&&n[e].find(t=>K(t)))return!0}return!1},T=n=>F?n:new Promise(e=>{let t=new FileReader;t.onload=()=>{let s=new File([t.result],n.name,{lastModified:n.lastModified,type:n.type});e(s)},t.readAsArrayBuffer(n)}),$=class{ws;url;constructor(e){this.ws=new WebSocket(e),this.url=e}send(e){return Array.isArray(e)?(e.forEach(t=>this.send(t)),this):(this.ws.send(typeof e=="object"?JSON.stringify(e):e.toString()),this)}on(e,t,s){return this.addEventListener(e,t,s)}off(e,t,s){return this.ws.removeEventListener(e,t,s),this}subscribe(e,t){return this.addEventListener("message",e,t)}addEventListener(e,t,s){return this.ws.addEventListener(e,c=>{if(e==="message"){let r=c.data.toString(),u=r.charCodeAt(0);if(u===47||u===123)try{r=JSON.parse(r)}catch{}else x(r)?r=+r:r==="true"?r=!0:r==="false"&&(r=!1);t({...c,data:r})}else t(c)},s),this}removeEventListener(e,t,s){return this.off(e,t,s),this}close(){return this.ws.close(),this}},M=(n,e="",t)=>new Proxy(()=>{},{get(s,c,r){return M(n,`${e}/${c.toString()}`,t)},apply(s,c,[r,u={}]=[{},{}]){let y=r!==void 0&&(typeof r!="object"||Array.isArray(r))?r:void 0,{$query:j,$fetch:O,$headers:I,$transform:g,getRaw:P,...C}=r??{};y??=C;let w=e.lastIndexOf("/"),E=e.slice(w+1).toUpperCase(),S=W(n,w===-1?"/":e.slice(0,w),Object.assign(u.query??{},j)),q=t.fetcher??fetch,p=t.transform?Array.isArray(t.transform)?t.transform:[t.transform]:void 0,v=g?Array.isArray(g)?g:[g]:void 0;return v&&(p?p=v.concat(p):p=v),E==="SUBSCRIBE"?new $(S.replace(/^([^]+):\/\//,S.startsWith("https://")?"wss://":"ws://")):(async N=>{let a,R={...t.$fetch?.headers,...O?.headers,...u.headers,...I};if(E!=="GET"&&E!=="HEAD"){a=Object.keys(y).length||Array.isArray(y)?y:void 0;let i=a&&(typeof a=="object"||Array.isArray(y));if(i&&J(a)){let h=new FormData;for(let[m,f]of Object.entries(a))if(F)h.append(m,f);else if(f instanceof File)h.append(m,await T(f));else if(f instanceof FileList)for(let l=0;l<f.length;l++)h.append(m,await T(f[l]));else if(Array.isArray(f))for(let l=0;l<f.length;l++){let k=f[l];h.append(m,k instanceof File?await T(k):k)}else h.append(m,f);a=h}else a!=null&&(R["content-type"]=i?"application/json":"text/plain",a=i?JSON.stringify(a):y)}let o=await q(S,{method:E,body:a,...t.$fetch,...u.fetch,...O,headers:R}),b;if(N.getRaw)return o;switch(o.headers.get("Content-Type")?.split(";")[0]){case"application/json":b=await o.json();break;default:b=await o.text().then(i=>x(i)?+i:i==="true"?!0:i==="false"?!1:i)}let D=o.status>=300||o.status<200?new L(o.status,b):null,A={data:b,error:D,response:o,status:o.status,headers:o.headers};if(p)for(let i of p){let d=i(A);d instanceof Promise&&(d=await d),d!=null&&(A=d)}return A})({getRaw:P})}}),z=(n,e={fetcher:fetch})=>new Proxy({},{get(t,s){return M(n,s,e)}});export{$ as a,z as b};
