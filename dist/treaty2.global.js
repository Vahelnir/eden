"use strict";var Eden=(()=>{var R=Object.defineProperty;var U=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var Z=Object.prototype.hasOwnProperty;var $=(e,t)=>{for(var n in t)R(e,n,{get:t[n],enumerable:!0})},B=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of V(t))!Z.call(e,c)&&c!==n&&R(e,c,{get:()=>t[c],enumerable:!(s=U(t,c))||s.enumerable});return e};var G=e=>B(R({},"__esModule",{value:!0}),e);var re={};$(re,{streamResponse:()=>P,treaty:()=>se});var A=class extends Error{constructor(n,s){super(s+"");this.status=n;this.value=s}};var z=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,Q=/(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s\d{2}\s\d{4}\s\d{2}:\d{2}:\d{2}\sGMT(?:\+|-)\d{4}\s\([^)]+\)/,X=/^(?:(?:(?:(?:0?[1-9]|[12][0-9]|3[01])[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:19|20)\d{2})|(?:(?:19|20)\d{2}[/\s-](?:0?[1-9]|1[0-2])[/\s-](?:0?[1-9]|[12][0-9]|3[01]))))(?:\s(?:1[012]|0?[1-9]):[0-5][0-9](?::[0-5][0-9])?(?:\s[AP]M)?)?$/,W=e=>e.trim().length!==0&&!Number.isNaN(Number(e)),K=e=>{if(typeof e!="string")return null;let t=e.replace(/"/g,"");if(z.test(t)||Q.test(t)||X.test(t)){let n=new Date(t);if(!Number.isNaN(n.getTime()))return n}return null},Y=e=>{let t=e.charCodeAt(0),n=e.charCodeAt(e.length-1);return t===123&&n===125||t===91&&n===93},ee=e=>JSON.parse(e,(t,n)=>{let s=K(n);return s||n}),C=e=>{if(!e)return e;if(W(e))return+e;if(e==="true")return!0;if(e==="false")return!1;let t=K(e);if(t)return t;if(Y(e))try{return ee(e)}catch{}return e};var I=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,L=class{constructor(t){this.url=t;this.ws=new WebSocket(t)}ws;send(t){return Array.isArray(t)?(t.forEach(n=>this.send(n)),this):(this.ws.send(typeof t=="object"?JSON.stringify(t):t.toString()),this)}on(t,n,s){return this.addEventListener(t,n,s)}off(t,n,s){return this.ws.removeEventListener(t,n,s),this}subscribe(t,n){return this.addEventListener("message",t,n)}addEventListener(t,n,s){return this.ws.addEventListener(t,c=>{if(t==="message"){let r=c.data.toString(),a=r.charCodeAt(0),h=r.charCodeAt(r.length-1);if(a===91||a===123)try{r=JSON.parse(r,(F,p)=>{if(typeof p=="string"&&I.test(p)){let y=new Date(p);if(!Number.isNaN(y.getTime()))return y}return p})}catch{}else W(r)?r=+r:r==="true"?r=!0:r==="false"?r=!1:r==="null"?r=null:a===34&&h===34&&I.test(r)&&(r=new Date(r.substring(1,r.length-1)));n({...c,data:r})}else n(c)},s),this}removeEventListener(t,n,s){return this.off(t,n,s),this}close(){return this.ws.close(),this}};var te=["get","post","put","delete","patch","options","head","connect","subscribe"],J=["localhost","127.0.0.1","0.0.0.0"],M=typeof FileList>"u",q=e=>M?e instanceof Blob:e instanceof FileList||e instanceof File,ne=e=>{if(!e)return!1;for(let t in e)if(q(e[t])||Array.isArray(e[t])&&e[t].find(q))return!0;return!1},j=e=>M?e:new Promise(t=>{let n=new FileReader;n.onload=()=>{let s=new File([n.result],e.name,{lastModified:e.lastModified,type:e.type});t(s)},n.readAsArrayBuffer(e)}),S=(e,t,n={},s={})=>{if(Array.isArray(e)){for(let c of e)if(!Array.isArray(c))s=S(c,t,n,s);else{let r=c[0];if(typeof r=="string")s[r.toLowerCase()]=c[1];else for(let[a,h]of r)s[a.toLowerCase()]=h}return s}if(!e)return s;switch(typeof e){case"function":if(e instanceof Headers)return S(e,t,n,s);let c=e(t,n);return c?S(c,t,n,s):s;case"object":if(e instanceof Headers)return e.forEach((r,a)=>{s[a.toLowerCase()]=r}),s;for(let[r,a]of Object.entries(e))s[r.toLowerCase()]=a;return s;default:return s}};async function*P(e){let t=e.body;if(!t)return;let n=t.getReader(),s=new TextDecoder;try{for(;;){let{done:c,value:r}=await n.read();if(c)break;let a=s.decode(r);yield C(a)}}finally{n.releaseLock()}}var x=(e,t,n=[],s)=>new Proxy(()=>{},{get(c,r){return x(e,t,r==="index"?n:[...n,r],s)},apply(c,r,[a,h]){if(!a||h||typeof a=="object"&&Object.keys(a).length!==1||te.includes(n.at(-1))){let F=[...n],p=F.pop(),y="/"+F.join("/"),{fetcher:_=fetch,headers:O,onRequest:g,onResponse:E,fetch:H}=t,k=p==="get"||p==="head"||p==="subscribe";O=S(O,y,h);let D=k?a?.query:h?.query,T="";if(D){let i=(b,m)=>{T+=(T?"&":"?")+`${encodeURIComponent(b)}=${encodeURIComponent(m)}`};for(let[b,m]of Object.entries(D)){if(Array.isArray(m)){for(let f of m)i(b,f);continue}i(b,`${m}`)}}if(p==="subscribe"){let i=e.replace(/^([^]+):\/\//,e.startsWith("https://")?"wss://":e.startsWith("http://")||J.find(b=>e.includes(b))?"ws://":"wss://")+y+T;return new L(i)}return(async()=>{let i={method:p?.toUpperCase(),body:a,...H,headers:O};i.headers={...O,...S(k?a?.headers:h?.headers,y,i)};let b=k&&typeof a=="object"?a.fetch:h?.fetch;if(i={...i,...b},k&&delete i.body,g){Array.isArray(g)||(g=[g]);for(let d of g){let o=await d(y,i);typeof o=="object"&&(i={...i,...o,headers:{...i.headers,...S(o.headers,y,i)}})}}if(k&&delete i.body,ne(a)){let d=new FormData;for(let[o,l]of Object.entries(i.body)){if(M){d.append(o,l);continue}if(l instanceof File){d.append(o,await j(l));continue}if(l instanceof FileList){for(let w=0;w<l.length;w++)d.append(o,await j(l[w]));continue}if(Array.isArray(l)){for(let w=0;w<l.length;w++){let N=l[w];d.append(o,N instanceof File?await j(N):N)}continue}d.append(o,l)}i.body=d}else typeof a=="object"?(i.headers["content-type"]="application/json",i.body=JSON.stringify(a)):a!=null&&(i.headers["content-type"]="text/plain");if(k&&delete i.body,g){Array.isArray(g)||(g=[g]);for(let d of g){let o=await d(y,i);typeof o=="object"&&(i={...i,...o,headers:{...i.headers,...S(o.headers,y,i)}})}}let m=e+y+T,f=await(s?.handle(new Request(m,i))??_(m,i)),u=null,v=null;if(E){Array.isArray(E)||(E=[E]);for(let d of E)try{let o=await d(f.clone());if(o!=null){u=o;break}}catch(o){o instanceof A?v=o:v=new A(422,o);break}}if(u!==null)return{data:u,error:v,response:f,status:f.status,headers:f.headers};switch(f.headers.get("Content-Type")?.split(";")[0]){case"text/event-stream":u=P(f);break;case"application/json":u=await f.json();break;case"application/octet-stream":u=await f.arrayBuffer();break;case"multipart/form-data":let d=await f.formData();u={},d.forEach((o,l)=>{u[l]=o});break;default:u=await f.text().then(C)}return(f.status>=300||f.status<200)&&(v=new A(f.status,u),u=null),{data:u,error:v,response:f,status:f.status,headers:f.headers}})()}return typeof a=="object"?x(e,t,[...n,Object.values(a)[0]],s):x(e,t,n)}}),se=(e,t={})=>typeof e=="string"?(t.keepDomain||(e.includes("://")||(e=(J.find(n=>e.includes(n))?"http://":"https://")+e),e.endsWith("/")&&(e=e.slice(0,-1))),x(e,t)):(typeof window<"u"&&console.warn("Elysia instance server found on client side, this is not recommended for security reason. Use generic type instead."),x("http://e.ly",t,[],e));return G(re);})();
